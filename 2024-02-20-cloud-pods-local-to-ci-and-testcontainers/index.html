<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=stylesheet href=/css/vendor/custom.css><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=/main.b93f21975a8c509862bc461126163a533d1083c67ad9fe8621b9b49c72f22af2f868498b9be3305e5c0243d5b194d4e9df7ec3a49e44fa797de7700c870708a0.css integrity="sha512-uT8hl1qMUJhivEYRJhY6Uz0Qg8Z62f6GIbm0nHLyKvL4aEmLm+MwXlwCQ9WxlNTp337DpJ5E+nl953AMhwcIoA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Mastering AWS Infrastructure Testing with LocalStack Cloud Pods - on localhost, CI and Testcontainers - LocalStack</title><meta name=description content="Discover how LocalStack Cloud Pods enable efficient testing of your applications by providing snapshots of AWS infrastructure for local development, continuous integration, and Testcontainers integration."><link rel=canonical href=/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.localstack.cloud/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/cloud-pods-2024.png"><meta name=twitter:title content="Mastering AWS Infrastructure Testing with LocalStack Cloud Pods - on localhost, CI and Testcontainers"><meta name=twitter:description content="Discover how LocalStack Cloud Pods enable efficient testing of your applications by providing snapshots of AWS infrastructure for local development, continuous integration, and Testcontainers integration."><meta name=twitter:site content="@localstack"><meta name=twitter:creator content="@localstack"><meta property="og:title" content="Mastering AWS Infrastructure Testing with LocalStack Cloud Pods - on localhost, CI and Testcontainers"><meta property="og:description" content="Discover how LocalStack Cloud Pods enable efficient testing of your applications by providing snapshots of AWS infrastructure for local development, continuous integration, and Testcontainers integration."><meta property="og:type" content="article"><meta property="og:url" content="/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/"><meta property="og:image" content="/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/cloud-pods-2024.png"><meta property="article:published_time" content="2024-02-20T00:00:00+00:00"><meta property="article:modified_time" content="2024-02-20T00:00:00+00:00"><meta property="og:site_name" content="LocalStack"><meta property="article:publisher" content="https://www.facebook.com/"><meta property="article:author" content="https://www.facebook.com/"><meta property="og:locale" content="en_US"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/blog.localstack.cloud\/"},{"@type":"ListItem","position":3,"name":"2024 02 20 Cloud Pods Local to Ci and Testcontainers","item":"https:\/\/blog.localstack.cloud\/\/2024-02-20-cloud-pods-local-to-ci-and-testcontainers\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#6b7cf5><link rel=manifest href=/site.webmanifest><script>(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-101988473-1','auto'),ga('send','pageview')</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-QRFTZPWGB7"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-QRFTZPWGB7')</script><script defer src=https://unpkg.com/@tinybirdco/flock.js data-host=https://api.tinybird.co data-token=p.eyJ1IjogIjAwZDRjYzRjLTg4N2UtNGNmZS05YzY4LTJjNzMyNjE5ODdjMCIsICJpZCI6ICI2YzRhMDViNi1iZjVlLTRkY2QtODNlZS1jMmFjYjg5ZjQ1NzAifQ.EPdBzyAb28wUbtZacobblsMi42IwTd7d2amppDfw-jE></script><script type=text/javascript id=hs-script-loader async defer src=//js-eu1.hs-scripts.com/26596507.js></script><script type=text/javascript src=//js-eu1.hsforms.net/forms/embed/v2.js></script><script>function toggleTag(b){const c='tag-'+b;if(c!=='tag-all'){const a=document.getElementsByClassName('tag-all');for(let b=0;b<a.length;b++){const c=a[b];c.classList.add('d-none')}}const d=document.getElementsByClassName(c);for(let a=0;a<d.length;a++){const b=d[a];b.classList.remove('d-none')}const e=document.getElementsByClassName('filterButton');for(let a=0;a<e.length;a++){const b=e[a];b.classList.remove('bg-purple'),b.classList.remove('btn-primary'),b.classList.add('btn-outline-primary')}const f=b+"FilterButton",a=document.getElementById(f);a.classList.add('bg-purple'),a.classList.add('btn-primary'),a.classList.remove('btn-outline-primary')}</script></head><body class="page single"><header></header><section class="section section-sm bg-gradient-dark"><div class="position-absolute w-100 section pb-7 pt-7 d-none d-md-block"><div class=container><div class="row justify-content-center align-items-center"><div class=col-2><img class=w-100 style=transform:scale(2);opacity:.65 src=/images/heroes/blog.svg></div><div class=col-2></div><div class=col-2></div><div class=col-2><img class=w-100 style=transform:rotate(35deg)scale(1.4);opacity:.9 src=/images/heroes/blog.svg></div><div class=col-2><img class=w-100 style=transform:rotate(-45deg)scaleX(-1)scale(1.5);opacity:.75 src=/images/heroes/blog.svg></div></div></div></div><div class="container pb-5 pt-6 pb-md-7 pt-sm-7"><div class="row justify-content-center align-items-center text-white"><h1 class="text-center m-0 pt-lg-5">Mastering AWS Infrastructure Testing with LocalStack Cloud Pods - on localhost, CI and Testcontainers</h1></div></div></section><section class="section section-sm mb-6"><div class="container px-lg-8"><div class="row justify-content-center"><div class=col-12><article><div class=blog-header><div class="d-flex align-items-center flex-wrap card-footer-text"><p class=mb-0><img src=/images/common/clock.svg>
11&nbsp;MIN READ&nbsp;&#8212;&nbsp;
posted February 20, 2024 by <a class="stretched-link position-relative">Anca Ghenade</a></p><p></div></div><p class=lead>Discover how LocalStack Cloud Pods enable efficient testing of your applications by providing snapshots of AWS infrastructure for local development, continuous integration, and Testcontainers integration.</p><img class="img-simple img-fluid lazyload blur-up" src=/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/cloud-pods-2024_hu2875c892b53266fcb550adeeb14725f5_719111_20x0_resize_box_2.png data-src=/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/cloud-pods-2024.png width=3048 height=1600 alt="A LocalStack Cloud Pods banner"><h2 id=cloud-pods-state--persistence-in-the-localstack-ecosystem>Cloud Pods, State & Persistence in the LocalStack ecosystem</h2><p>In a few words, LocalStack is a cloud service emulator that allows you to develop and test your cloud and serverless applications
locally by replicating AWS environments on any machine without the need to deploy them to the actual AWS cloud. This tool
provides an easy and cost-effective way to test cloud applications by locally providing all the necessary dependencies.</p><p>LocalStack ships as a Docker container, making its state ephemeral by default. Once the container shuts down, all the
services and data are gone. So, in an attempt to solve this issue, the LocalStack engineers came up with some solutions
that could be applied on a case-by-case basis. These are Persistence, State, and Cloud Pods. To better understand the
differences between these approaches, we can simplify them in a diagram:</p><img class="img-simple img-fluid lazyload blur-up" src=/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/persistence-pods-remote_hu14ac2f60125c988298a465079699b7e0_768278_20x0_resize_box_2.png data-src=/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/persistence-pods-remote.png width=3840 height=2160 alt="The difference between persistence, local state and Cloud Pods."><p>Anything that is inside a LocalStack container constitutes the &ldquo;state.” The &ldquo;state&rdquo; can either be persisted on your local
machine and be loaded at startup, exported anytime as a single local file (state export), or stored on the LocalStack platform (cloud pods).
The underlying mechanisms of all three solutions are similar, but the layout obviously differs. We can observe how using state
locally and Cloud Pods are very similar, one might even consider them <code>local</code> and <code>remote</code> Pods. That being said, in this
article, we will focus on Cloud Pods and what problems they solve while glancing at the <em>local state</em> from time to time.</p><p>Simply put, a Cloud Pod is a persistent state snapshot of your LocalStack instance. Think of it as a snapshot of a database
from which you can restore the tables and all associated data.</p><p>Cloud Pods are not very rigid, though. They also enable users to selectively capture the configuration and data of only
specific services, making them highly adaptable and tailored to diverse development and testing needs.</p><h2 id=cloud-pods-how-do-they-work>Cloud Pods: How do they work?</h2><p>There are several reasons why the concept of Cloud Pods plays a crucial role in the LocalStack ecosystem.</p><img class="img-simple img-fluid lazyload blur-up" src=/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/cloud-pods-tf_hu3700846342859ce5144e639e5e8cf471_392995_20x0_resize_box_2.png data-src=/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/cloud-pods-tf.png width=3840 height=2160 alt="A diagram depicting ways to take of snapshot of the LocalStack instance."><p>Focusing solely on Cloud Pods and state, this diagram illustrates the relationship and workflows between the LocalStack instance,
local state, Cloud Pods, and the LocalStack Platform:</p><ol><li>The LocalStack Instance runs on a host machine, and the required infrastructure is created via a Terraform configuration
file. The AWS resources interact with each other, meaning that more complex cloud scenarios can be tested.</li></ol><p>The LocalStack Instance can locally export its state by using the <code>state export</code> command, and at the same time, it can
inject a state using <code>state import.</code></p><ol start=2><li>The LocalStack Platform (on the right) stores Cloud Pod artifacts by default when using the <code>pod save</code> command. When
pushing an already existing pod, a new version is created and subsequently uploaded to the platform. Complementary, the
<code>pod load</code> command is used to inject a Cloud Pod.</li></ol><p>The user can emulate AWS cloud services on their local machine with LocalStack, save the configurations into versioned
Cloud Pods, and additionally share or store these configurations on the LocalStack Platform. It&rsquo;s a way to manage development
and testing environments with reproducibility and version control.
The <a href=https://docs.localstack.cloud/user-guide/state-management/pods-cli/>state management</a> section of the documentation
offers a comprehensive explanation of all the CLI commands.</p><h2 id=why-use-cloud-pods>Why use Cloud Pods</h2><h3 id=sharing-and-collaboration>Sharing and Collaboration</h3><p>LocalStack&rsquo;s snapshot feature significantly enhances team collaboration on cloud applications by enabling the capture
and sharing of AWS services' precise configurations and data. This ensures consistent development environments across
teams, resolves discrepancies, and facilitates efficient onboarding and troubleshooting. By simplifying the synchronization
of workspaces through LocalStack&rsquo;s remote platform, Cloud Pods accelerates development cycles and ensures faster and more
dependable tests.</p><h3 id=modularity-and-flexibility>Modularity and Flexibility</h3><p>LocalStack&rsquo;s Cloud Pods offer enhanced modularity and flexibility, enabling teams to configure distinct, purpose-specific
testing environments. For instance, one Cloud Pod can replicate a production database for final-stage testing, while another
can host a database filled with edge cases for validation testing. This nuanced approach not only allows targeted testing of
application components under changing conditions but also strengthens test integrity by preventing data overlap and ensuring
isolation.</p><p>Another practical application is providing layering of different datasets on the same infrastructure, which is crucial for machine learning applications to create reproducible samples. This method ensures that training datasets and the corresponding code logic for ML models are packaged together, enhancing reproducibility and streamlining development workflows in an engineering-focused environment.</p><h3 id=efficiency-and-speed>Efficiency and Speed</h3><p>Cloud Pods boost efficiency in cloud application development by cutting down environment setup times. Compared to
traditional infrastructure provisioning, like a full Terraform stack setup, LocalStack&rsquo;s injection of pre-configured
Cloud Pods reduces setup time from minutes to mere seconds. This rapid deployment not only accelerates the development
cycle but also allows developers to focus more on actual work and less on waiting, aligning perfectly with the demands of
agile methodologies and fast-paced project timelines.</p><h2 id=talk-is-cheap-show-me-the-code>&ldquo;Talk is cheap. Show me the code.”</h2><p>We’ve mentioned some of the strong points of Cloud Pods. Let’s now see them deliver on those promises. You can follow
along with all the examples by cloning the <a href=https://github.com/localstack-samples/localstack-cloud-pods-blogpost-demo><strong>demo repository</strong></a>.</p><h3 id=accelerating-development-and-testing>Accelerating development and testing</h3><p>The following recording shows the comparison in time spent waiting for the same infrastructure to be set up, first using
Terraform and then via Cloud Pods:</p><p><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/aDis2kOtqtw style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><br></p><p>The results speak for themselves: 1 minute 32 seconds vs 15 seconds. If your stack is generally stable and is not actively
being built, you can easily focus on your application logic and use Cloud Pods rather than provision your infrastructure
using IaC tools every time. Alternatively, you can also export the state of your LocalStack instance or create a Cloud Pod
using only the desired services with the <code>--services</code> flag.</p><p>Now, we can kick it up a notch and introduce the same speed in CI. This example follows three workflows described in the
same <a href=https://github.com/localstack-samples/localstack-cloud-pods-blogpost-demo><strong>repository</strong></a>. All the runs are doing the same thing:
setting up the environment, starting LocalStack, spinning up the desired resources, and, as a final check, verifying
if the buckets with the correct name exist.</p><p>We can see that both workflows using Pods have a shorter running time, whether they’re using local files or remotely stored ones.
This is also because you can skip some more steps in the workflows, such as installing Java and Maven and building the Lambda jars.
For a one-time run, the differences are 1 minute and 42 seconds and 1 minute 40 seconds, but let’s remember that this stack is
only using a few services: IAM, STS, SQS, SNS, DynamoDB, S3, Lambda, KMS, Kinesis, and CloudWatch. All these minutes add up
with every workflow you run, and in this scenario, the run time went down by 42,8% and 42%, respectively. Meanwhile, the
developer running this on their machine has reduced the waiting time by 84%.</p><img class="img-simple img-fluid lazyload blur-up" src=/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/ci-workflows_hu8dc388ae80cbdbe6eea685a00ef4d0a6_123055_20x0_resize_box_2.png data-src=/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/ci-workflows.png width=2140 height=410 alt="Three GitHub action workflows using Cloud Pods."><h3 id=optimizing-collaboration-and-enhancing-teamwork>Optimizing collaboration and enhancing teamwork</h3><p>In this instance, we&rsquo;ll see how Cloud Pods improve team collaboration by optimizing AWS infrastructure updates. From a bird’s eye
view, the process looks like this:</p><img class="img-simple img-fluid lazyload blur-up" src=/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/localstack-in-ci-create-pod_huc220ac05448bff90eff1cec1803093de_423738_20x0_resize_box_2.png data-src=/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/localstack-in-ci-create-pod.png width=3840 height=2160 alt="Creating Cloud Pods on changes to the IaC file."><p>We utilize a GitHub Action to trigger a workflow whenever the IaC configuration files are
modified (<code>.github/workflows/create-cloud-pod-on-infra-change.yml</code>). This action creates a new Cloud Pod and uploads it to
the LocalStack Platform, providing a centralized access point for the team. Consequently, our application&rsquo;s build and test
workflows can incorporate the newest Pod (<code>terraform-shipment-pod</code>), ensuring that everyone consistently works with the latest
infrastructure changes. This method ensures that each team member is aligned with the most recent developments, promoting
efficiency and coherence in engineering processes.</p><p>After each run, the updated Cloud Pod version is visible in the web application dashboard.</p><img class="img-simple img-fluid lazyload blur-up" src=/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/localstack-pods-dashboard_hu5fe048ad79ffaa476b649608380aebc8_173648_20x0_resize_box_2.png data-src=/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/localstack-pods-dashboard.png width=2156 height=1138 alt="LocalStack Cloud Pod dashboard"><p>Upon closer inspection, the user can discover more information about each version of the Cloud Pod and, if needed, can choose from any older rendition to recover the LocalStack state. Be careful though, there is an auto-cleanup setting that will make sure old versions of Cloud Pods are cleaned up automatically. All versions of a Cloud Pod that exceed a threshold set by the users will be deleted. This can be 5, or it can be 20, depending on your needs.</p><img class="img-simple img-fluid lazyload blur-up" src=/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/cloud-pod-details_hu1b9764b5963b6ce0ce87dab41a2345fd_154758_20x0_resize_box_2.png data-src=/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/cloud-pod-details.png width=2140 height=810 alt="Cloud Pod detail in web app"><p>The integration of Cloud Pods into your CI pipelines significantly streamlines the process. Once new code is pushed and the workflow starts, LocalStack retrieves a Cloud Pod and pre-seeds its state in a matter of seconds, enabling integration tests to start as fast as possible. This swift setup significantly accelerates CI runs, ensuring rapid feedback and a more efficient development cycle while also enhancing the overall robustness and reliability of the development pipeline.</p><img class="img-simple img-fluid lazyload blur-up" src=/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/localstack-remote-platform-ci_huc220ac05448bff90eff1cec1803093de_443269_20x0_resize_box_2.png data-src=/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/localstack-remote-platform-ci.png width=3840 height=2160 alt="Diagram showing Cloud Pods pulled from the LocalStack Platform for CI use"><h3 id=integration-with-testcontainers>Integration with Testcontainers</h3><p>Integrating LocalStack Cloud Pods with Testcontainers will improve and accelerate your testing process, particularly addressing
the prevalent pain point where Infrastructure as Code (IaC) tools like Terraform or Pulumi face challenges running against
LocalStack during tests. Traditionally, this limitation nudged developers towards the more cumbersome and time-intensive route of
utilizing SDK clients to create resources manually. However, the synergy between Cloud Pods and Testcontainers' features
elegantly circumvents this bottleneck. By enabling developers to swiftly inject predefined state into the LocalStack container,
these tools collectively foster a more efficient and seamless integration. This capability not only saves precious time but
also allows developers to bypass the initial setup hurdles and leap directly into the crux of actual testing. Consequently,
this integration harmonizes the flow between local and cloud environments, ensuring a smoother and more productive development
lifecycle.</p><p>In our sample application, we have covered two scenarios of provisioning our infrastructure for testing: using Cloud Pods
stored on the LocalStack Platform and using the locally stored state file. You can view the full test suites in the same
<a href=https://github.com/localstack-samples/localstack-cloud-pods-blogpost-demo><strong>repository</strong></a>, under the <code>src/test</code> folder.</p><h4 id=cloud-pods>Cloud Pods</h4><p>Setting up the testing environment for running application tests against LocalStack is easy and straightforward:</p><pre><code class=language-java>@Container
    protected static LocalStackContainer localStack =
            new LocalStackContainer(DockerImageName.parse(&quot;localstack/localstack-pro:latest&quot;))
                    .withEnv(&quot;LOCALSTACK_AUTH_TOKEN&quot;, System.getenv(&quot;LOCALSTACK_AUTH_TOKEN&quot;))
                    .withEnv(&quot;LOCALSTACK_HOST&quot;, &quot;localhost.localstack.cloud&quot;)
                    .withEnv(&quot;LAMBDA_RUNTIME_ENVIRONMENT_TIMEOUT&quot;, &quot;60&quot;)
                    .withEnv(&quot;AUTO_LOAD_POD&quot;, &quot;terraform-shipment-pod&quot;);
</code></pre><ul><li>The <em><strong>@Container</strong></em> annotation is used in conjunction with the Testcontainers annotation (at the top of the class) to mark containers that should be managed by the Testcontainers framework.</li><li>A new instance of a <code>LocalStackContainer</code> using the LocalStack Docker image tagged <code>localstack-pro:latest</code> is created.</li><li><code>LOCALSTACK_AUTH_TOKEN</code> environment variable refers to your own token for the Pro license.</li><li><code>LOCALSTACK_HOST</code> is the name of the host that exposes the services externally. This host is used, for example, when returning queue URLs from the SQS service to the client.</li><li><code>LAMBDA_RUNTIME_ENVIRONMENT_TIMEOUT</code> sets the timeout for the Lambda runtime environment to 60 seconds.</li><li>Most importantly, to get the ball rolling, <code>AUTO_LOAD_POD</code> will tell LocalStack which Cloud Pod to fetch and inject from the remote platform.</li></ul><p>Before testing can start, we still need to remember that setting up the necessary resources takes time, even if it’s just a few seconds.
That’s why we need to make sure that they exist before we use them. In this instance, we picked the Lambda function as a checkpoint,
but depending on your own resources and workflows tested, this can be adapted:</p><pre><code class=language-java>@BeforeAll
    static void waitForLambdaToBeReady() {

        LambdaClient lambdaClient = LambdaClient.builder()
                .region(Region.of(localStack.getRegion()))
                .endpointOverride(localStack.getEndpointOverride(LocalStackContainer.Service.LAMBDA))
                .credentialsProvider(StaticCredentialsProvider.create(
                        AwsBasicCredentials.create(localStack.getAccessKey(), localStack.getSecretKey())))
                .build();

        WaiterOverrideConfiguration overrideConfig = WaiterOverrideConfiguration.builder()
                .maxAttempts(20)
                .build();

        LambdaWaiter waiter = LambdaWaiter.builder()
                .client(lambdaClient)
                .overrideConfiguration(overrideConfig)
                .build();

        GetFunctionRequest getFunctionRequest = GetFunctionRequest.builder()
                .functionName(&quot;shipment-picture-lambda-validator&quot;).build();

        WaiterResponse&lt;GetFunctionResponse&gt; waiterResponse = waiter.waitUntilFunctionExists(getFunctionRequest);
        waiterResponse.matched().response().ifPresent(response -&gt; LOGGER.info(response.toString()));

    }
</code></pre><p>To summarize, this code snippet configures a Lambda client and uses a waiter to check and wait until the specified Lambda
function (<code>shipment-picture-lambda-validator</code>) is ready before proceeding with the tests. This ensures that the tests only
run when the necessary AWS resources are available in the LocalStack environment.</p><p>After everything is in place, the Spring Boot application will start up, and the tests can make sure the business logic is behaving
as expected.</p><img class="img-simple img-fluid lazyload blur-up" src=/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/testcontainers-workflow-tests_hu07ce9d9a18d3cdf510c1c0ab4794b725_134742_20x0_resize_box_2.png data-src=/2024-02-20-cloud-pods-local-to-ci-and-testcontainers/testcontainers-workflow-tests.png width=1892 height=468 alt="Workflow tests using Testcontainers"><h3 id=local-state>Local state</h3><p>Similarly to using Cloud Pods, we can harness a similarly efficient strategy with locally exported state files. These files are
integrated into the Docker container as mounted volumes, residing at a designated path (<code>etc/localstack/init-pods.d</code>). Just like
with initialization hooks, this setup ensures that the container scans this specific folder during startup, identifying and
utilizing relevant files, thereby optimizing infrastructure initialization with ease. The setup will look the same, with the
exception of one field, where we provide the path to our file:</p><pre><code class=language-java>@Container
    protected static LocalStackContainer localStack =
            new LocalStackContainer(DockerImageName.parse(&quot;localstack/localstack-pro:latest&quot;))
                    .withEnv(&quot;LOCALSTACK_AUTH_TOKEN&quot;, System.getenv(&quot;LOCALSTACK_AUTH_TOKEN&quot;))
                    .withEnv(&quot;LOCALSTACK_HOST&quot;, &quot;localhost.localstack.cloud&quot;)
                    .withEnv(&quot;LAMBDA_RUNTIME_ENVIRONMENT_TIMEOUT&quot;, &quot;60&quot;)
                    .withFileSystemBind(&quot;src/test/resources/init-pods.d&quot;,
                            &quot;/etc/localstack/init-pods.d&quot;);
</code></pre><p>The exported state resides in the <code>src/test/resources/init-pods.d</code> folder, which binds to the <code>/etc/localstack/init-pods.d</code>
path in the container.</p><p>Integrating LocalStack’s Cloud Pods with Testcontainers allows for efficient infrastructure setup and data preparation across
various scenarios. It provides a practical approach to layering different datasets on the same infrastructure, which is crucial for testing as many scenarios as needed.</p><h2 id=additional-details>Additional Details</h2><p>Cloud Pods are typically stored remotely, with the default storage location being the LocalStack platform. Nonetheless, for
organizations with specific data regulations or sovereignty concerns that preclude the use of remote storage infrastructures,
LocalStack offers the flexibility to store Cloud Pods on-premises, ensuring full control over storage. In terms of alternative
storage options, LocalStack supports two main types: S3 bucket remote storage and ORAS (OCI Registry as Storage) remote storage.
Additionally, LocalStack facilitates the management of these storage options through a command-line interface (CLI), providing
functionalities to create, delete, and list these remote storage locations for Cloud Pods. You can find all the necessary tools
for that in the <a href=https://docs.localstack.cloud/user-guide/state-management/cloud-pods/#remotes><strong>documentation</strong></a>.</p><h2 id=limitations>Limitations</h2><p>Cloud Pods are a powerful feature, though they are optimized to work with certain configurations. Primarily, matching the major
version of LocalStack with that of the Cloud Pod ensures compatibility and smooth functionality. Additionally, while most services
are fully supported, there are instances where certain service information may not be completely serialized into a Cloud Pod.
These nuances are minor and generally manageable within the framework and are also constantly <a href=https://docs.localstack.cloud/user-guide/state-management/persistence/#known-limitations><strong>documented</strong></a> and updated.</p><h2 id=conclusions>Conclusions</h2><p>Cloud Pods are fundamentally transforming the landscape of testing for AWS-powered applications, by offering a scalable
and efficient way to replicate AWS infrastructure locally and in CI, whether it&rsquo;s for fast development or integrating with
popular frameworks. This breakthrough, coupled with remote storage for Cloud Pods, significantly enhances team collaboration,
ensuring seamless and consistent testing experiences across the board.</p></article></div></div></div></section><section class="section bg-gradient-light"><div class=container><div class="row justify-content-center"><div class="d-flex flex-column gap-4 col-lg-12 text-white"><h2 class="h2 text-center">Stay in the loop</h2><p>We'd love to get in touch with you.
Please subscribe with your email to stay tuned for release notes and product updates.
We promise never to send an excessive amount of emails (we hate spam, too).</p><script>hbspt.forms.create({region:"eu1",portalId:"26596507",formId:"1cc99237-4ce0-4d65-abdf-f87ac2724717"})</script></div></div></div></section><footer class="footer pt-6 bg-gradient-dark"><div class="footer-main pb-5"><div class=container><div class="row justify-content-between"><div class="col-12 col-lg-4"><img style=width:243px src=/images/header-logo-new.svg alt="LocalStack Logo"></div><div class="col-12 col-lg-8 mt-4 mt-lg-0"><div class="row gap-4"><div class=col><ul class="list-unstyled gap-4 d-flex flex-column"><li><a class=footer-text href=https://localstack.cloud/contact>Contact</a></li><li><a class=footer-text href=https://localstack.cloud/careers>Careers</a></li><li><a class=footer-text href=https://blog.localstack.cloud>Blog</a></li><li><a class=footer-text href=https://docs.localstack.cloud>Docs</a></li></ul></div><div class=col><ul class="list-unstyled gap-4 d-flex flex-column"><li><a class=footer-text href=https://docs.localstack.cloud/tutorials/>Tutorials</a></li><li><a class=footer-text href=https://docs.localstack.cloud/applications/>Applications</a></li><li><a class=footer-text href=https://docs.localstack.cloud/academy/>LocalStack Academy</a></li></ul></div><div class=col><ul class="list-unstyled gap-4 d-flex flex-column"><li><a class=footer-text href=https://www.localstack.cloud/legal/tos>Terms and Conditions</a></li><li><a class=footer-text href=https://www.localstack.cloud/legal/privacy-policy>Privacy Policy</a></li><li><a class=footer-text href=https://assets-global.website-files.com/6539036f80ddc9e9a467134e/657b15a7f5ba23e41984d5dd_LocalStack%20DPA.pdf>Data Processing Addendum</a></li></ul></div><div class=col><ul class="list-unstyled gap-4 d-flex flex-column"><li class=footer-text>Follow us</li><li class="d-flex gap-3"><a class=footer-text href=https://twitter.com/localstack><span><svg width="26" height="26" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M25 13.25c0 6.9036-5.5964 12.5-12.5 12.5C5.59644 25.75.0 20.1536.0 13.25.0 6.34644 5.59644.75 12.5.75 19.4036.75 25 6.34644 25 13.25zm-6.56-3.0468C19.0443 10.1315 19.6205 9.97084 20.1562 9.73331 19.7558 10.3325 19.2493 10.8586 18.6651 11.2797 18.6709 11.4076 18.6738 11.5366 18.6738 11.6661c0 3.9487-3.0055 8.5014-8.5012 8.5014C8.48534 20.1675 6.91443 19.6731 5.59285 18.825 5.82615 18.8528 6.06457 18.8669 6.30522 18.8669 7.70545 18.8669 8.9936 18.3894 10.0164 17.5879 8.70861 17.5636 7.6054 16.6997 7.22527 15.5129 7.40754 15.5477 7.59449 15.5662 7.78745 15.5662 8.05952 15.5662 8.32401 15.5299 8.57447 15.4612c-1.36658-.2743-2.39692-1.4817-2.39692-2.9294C6.17755 12.5193 6.17755 12.5066 6.17777 12.4939 6.58041 12.7183 7.04144 12.8526 7.53098 12.868 6.7297 12.3323 6.20183 11.4174 6.20183 10.3811c0-.547520000000001.14751-1.06113.40465-1.50232C8.08024 10.687 10.282 11.8764 12.7651 12.001 12.7139 11.7822 12.6874 11.5542 12.6874 11.32c0-1.64975 1.338-2.98781 2.9878-2.98781.8599.0 1.6364.36276 2.1815.94322C18.5369 9.14149 19.1767 8.89304 19.754 8.55056 19.5305 9.24867 19.057 9.83358 18.44 10.2032z" fill="#fff"/></svg></span></a><a class=footer-text href=https://www.linkedin.com/company/localstack-cloud><span><svg width="26" height="26" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13 26c7.1797.0 13-5.8203 13-13S20.1797.0 13 0 0 5.8203.0 13 5.8203 26 13 26zM9.35126 10.5024C9.97963 10.5024 10.489 9.993 10.489 9.36463S9.97963 8.22687 9.35126 8.22687 8.2135 8.73626 8.2135 9.36463s.50939 1.13777 1.13776 1.13777zm2.21194.8622v6.3122h1.9599V14.5553C13.5231 13.7316 13.6781 12.9339 14.6993 12.9339c1.0073.0 1.0198.941700000000001 1.0198 1.6734v3.0701H17.68V14.2157C17.68 12.5153 17.3139 11.2086 15.3265 11.2086c-.9542.0-1.5938.5236-1.8554 1.0192H13.4446V11.3646H11.5632zm-3.19382.0H10.3324v6.3122H8.36938V11.3646z" fill="#fff"/></svg></span></a></li></ul></div></div></div></div></div></div><div class=footer-bottom><div class="container mb-2"><hr><div class="row pt-4"><div class=col style=color:#fff;opacity:.5>Copyright &copy; LocalStack</div><div class="col text-end"><ul class=list-inline></ul></div></div></div></div></footer><script src=/js/bootstrap.min.51b4083a09e54138d5bbe9c42a5f5f71af6e60a417f276d5620cbde3b15eb1a07c9ea17a889bc58074adf9b19641039a77521d3131f039300d2fe29ffa532aa8.js integrity="sha512-UbQIOgnlQTjVu+nEKl9fca9uYKQX8nbVYgy947FesaB8nqF6iJvFgHSt+bGWQQOad1IdMTHwOTANL+Kf+lMqqA==" crossorigin=anonymous defer></script><script src=/js/highlight.min.8cdbefd08ec63ef25f4b2510ae50c13b3d9ed43e25a15ddb55f14c33130e68cf8be3131ccf2d087c49f5f21fe88c2f0e2715a21f936047d0d0b85dc48cb864b9.js integrity="sha512-jNvv0I7GPvJfSyUQrlDBOz2e1D4loV3bVfFMMxMOaM+L4xMczy0IfEn18h/ojC8OJxWiH5NgR9DQuF3EjLhkuQ==" crossorigin=anonymous defer></script><script src=/main.min.8933efb6bcdc37606a11f732d52c6f65d7fc1d082b89d56516f6a1bfb528ee7c40c3430bb80214cdd129ec7d69d4cadd74e693da54a9ba6f08c44771204d4468.js integrity="sha512-iTPvtrzcN2BqEfcy1SxvZdf8HQgridVlFvahv7Uo7nxAw0MLuAIUzdEp7H1p1MrddOaT2lSpum8IxEdxIE1EaA==" crossorigin=anonymous defer></script><script src=/index.min.28297aad85d5f5902201eb4ef84e7012a37d4a34824e2256df80cd91e547bf155df22029e5596951d6f2692dd1fee54c76721b407e5ac526bd33bedc636a87e5.js integrity="sha512-KCl6rYXV9ZAiAetO+E5wEqN9SjSCTiJW34DNkeVHvxVd8iAp5VlpUdbyaS3R/uVMdnIbQH5axSa9M77cY2qH5Q==" crossorigin=anonymous defer></script></body></html>