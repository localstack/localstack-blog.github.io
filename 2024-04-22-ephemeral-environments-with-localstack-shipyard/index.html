<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=stylesheet href=/css/vendor/custom.css><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><link rel=stylesheet href=/main.b93f21975a8c509862bc461126163a533d1083c67ad9fe8621b9b49c72f22af2f868498b9be3305e5c0243d5b194d4e9df7ec3a49e44fa797de7700c870708a0.css integrity="sha512-uT8hl1qMUJhivEYRJhY6Uz0Qg8Z62f6GIbm0nHLyKvL4aEmLm+MwXlwCQ9WxlNTp337DpJ5E+nl953AMhwcIoA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><meta name=robots content="index, follow"><meta name=googlebot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><meta name=bingbot content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1"><title>Ephemeral Environments with LocalStack & Shipyard - LocalStack</title><meta name=description content="We're excited to announce our partnership with Shipyard. This integration empowers you to test your cloud applications in a short-lived, encapsulated deployment ‚Äî allowing you to shift left by fixing things before they break your production."><link rel=canonical href=/2024-04-22-ephemeral-environments-with-localstack-shipyard/><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.localstack.cloud/2024-04-22-ephemeral-environments-with-localstack-shipyard/ephemeral-environments-with-localstack-shipyard-banner.png"><meta name=twitter:title content="Ephemeral Environments with LocalStack & Shipyard"><meta name=twitter:description content="We're excited to announce our partnership with Shipyard. This integration empowers you to test your cloud applications in a short-lived, encapsulated deployment ‚Äî allowing you to shift left by fixing things before they break your production."><meta name=twitter:site content="@localstack"><meta name=twitter:creator content="@localstack"><meta property="og:title" content="Ephemeral Environments with LocalStack & Shipyard"><meta property="og:description" content="We're excited to announce our partnership with Shipyard. This integration empowers you to test your cloud applications in a short-lived, encapsulated deployment ‚Äî allowing you to shift left by fixing things before they break your production."><meta property="og:type" content="article"><meta property="og:url" content="/2024-04-22-ephemeral-environments-with-localstack-shipyard/"><meta property="og:image" content="/2024-04-22-ephemeral-environments-with-localstack-shipyard/ephemeral-environments-with-localstack-shipyard-banner.png"><meta property="article:published_time" content="2024-04-22T00:00:00+00:00"><meta property="article:modified_time" content="2024-04-22T00:00:00+00:00"><meta property="og:site_name" content="LocalStack"><meta property="article:publisher" content="https://www.facebook.com/"><meta property="article:author" content="https://www.facebook.com/"><meta property="og:locale" content="en_US"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"https:\/\/blog.localstack.cloud\/"},{"@type":"ListItem","position":3,"name":"2024 04 22 Ephemeral Environments With Localstack Shipyard","item":"https:\/\/blog.localstack.cloud\/\/2024-04-22-ephemeral-environments-with-localstack-shipyard\/"}]}</script><meta name=theme-color content="#fff"><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#6b7cf5><link rel=manifest href=/site.webmanifest><script>(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-101988473-1','auto'),ga('send','pageview')</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-QRFTZPWGB7"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-QRFTZPWGB7')</script><script defer src=https://unpkg.com/@tinybirdco/flock.js data-host=https://api.tinybird.co data-token=p.eyJ1IjogIjAwZDRjYzRjLTg4N2UtNGNmZS05YzY4LTJjNzMyNjE5ODdjMCIsICJpZCI6ICI2YzRhMDViNi1iZjVlLTRkY2QtODNlZS1jMmFjYjg5ZjQ1NzAifQ.EPdBzyAb28wUbtZacobblsMi42IwTd7d2amppDfw-jE></script><script type=text/javascript id=hs-script-loader async defer src=//js-eu1.hs-scripts.com/26596507.js></script><script type=text/javascript src=//js-eu1.hsforms.net/forms/embed/v2.js></script><script>function toggleTag(b){const c='tag-'+b;if(c!=='tag-all'){const a=document.getElementsByClassName('tag-all');for(let b=0;b<a.length;b++){const c=a[b];c.classList.add('d-none')}}const d=document.getElementsByClassName(c);for(let a=0;a<d.length;a++){const b=d[a];b.classList.remove('d-none')}const e=document.getElementsByClassName('filterButton');for(let a=0;a<e.length;a++){const b=e[a];b.classList.remove('bg-purple'),b.classList.remove('btn-primary'),b.classList.add('btn-outline-primary')}const f=b+"FilterButton",a=document.getElementById(f);a.classList.add('bg-purple'),a.classList.add('btn-primary'),a.classList.remove('btn-outline-primary')}</script></head><body class="page single"><header></header><section class="section section-sm bg-gradient-dark"><div class="position-absolute w-100 section pb-7 pt-7 d-none d-md-block"><div class=container><div class="row justify-content-center align-items-center"><div class=col-2><img class=w-100 style=transform:scale(2);opacity:.65 src=/images/heroes/blog.svg></div><div class=col-2></div><div class=col-2></div><div class=col-2><img class=w-100 style=transform:rotate(35deg)scale(1.4);opacity:.9 src=/images/heroes/blog.svg></div><div class=col-2><img class=w-100 style=transform:rotate(-45deg)scaleX(-1)scale(1.5);opacity:.75 src=/images/heroes/blog.svg></div></div></div></div><div class="container pb-5 pt-6 pb-md-7 pt-sm-7"><div class="row justify-content-center align-items-center text-white"><h1 class="text-center m-0 pt-lg-5">Ephemeral Environments with LocalStack & Shipyard</h1></div></div></section><section class="section section-sm mb-6"><div class="container px-lg-8"><div class="row justify-content-center"><div class=col-12><article><div class=blog-header><div class="d-flex align-items-center flex-wrap card-footer-text"><p class=mb-0><img src=/images/common/clock.svg>
11&nbsp;MIN READ&nbsp;&#8212;&nbsp;
posted April 22, 2024 by <a class="stretched-link position-relative">Harsh Mishra</a> and <a class="stretched-link position-relative">Natalie Lunbeck</a></p><p></div></div><p class=lead>We're excited to announce our partnership with Shipyard. This integration empowers you to test your cloud applications in a short-lived, encapsulated deployment ‚Äî allowing you to shift left by fixing things before they break your production.</p><img class="img-simple img-fluid lazyload blur-up" src=/2024-04-22-ephemeral-environments-with-localstack-shipyard/_huf35948a730209ed615c0b6761bd3bd63_1283249_4bc367e25ed5380094f8a49e9b6e754f.png data-src=/2024-04-22-ephemeral-environments-with-localstack-shipyard/ephemeral-environments-with-localstack-shipyard-banner.png width=1920 height=1080 alt="Banner image for the blog: Ephemeral environments with LocalStack & Shipyard"><h2 id=introduction>Introduction</h2><p>We‚Äôre excited to announce our partnership with <a href=https://shipyard.build>Shipyard</a>, the ephemeral environment self-service platform, that allows you to spin up on-demand preview deployments via Kubernetes clusters to turbocharge your application lifecycle. With Shipyard, you can now deploy your cloud applications in short-lived environments to enable developer teams to run tests, preview features, and get alignment with cross-departmental projects. Shipyard also enables application previews on every pull request and simplifies monitoring, debugging, and deployment all from one dashboard!</p><p>LocalStack‚Äôs core cloud emulator enables developers to build, test, and deploy cloud & serverless applications locally. Shipped as a Docker image, you can use various integrations such as the <code>docker</code> CLI, Docker Compose, or Helm to start LocalStack in a developer environment. Shipyard allows developers to use <a href=https://docs.docker.com/compose/>Docker Compose configurations</a> which are then automatically transpiled into Kubernetes manifests enabling you a pre-production preview of how your applications work! As such, LocalStack does not require any additional configurations and just enables you to start with a pre-defined Docker Compose setup.</p><p>In this blog, we‚Äôll detail why you should be using ephemeral environments and how you can use LocalStack alongside Shipyard. We‚Äôll also go through setting up an AWS-powered application on Shipyard & LocalStack, and how you can pre-seed infrastructure state using Cloud Pods!</p><h2 id=what-is-shipyard>What is Shipyard?</h2><p>Shipyard is a platform that allows you to create on-demand ephemeral environments to run your tests against a production-like setup. It simplifies pre-production testing, compliance, and collaboration by generating an ephemeral environment preview for your full-stack application on every pull request (PR) to give you a near-production experience while building and testing features. Every environment is a single-tenant cluster, enabling Single Sign-On (SSO) authentication. This ensures that not only developers but also other stakeholders can quickly access and work on developing features with a simple click.</p><p>In addition, you can use Shipyard for:</p><ul><li>Gaining terminal access into your running containers for live debugging.</li><li>Adding private container registries for pulling images during the build.</li><li>Integrating with GitHub Actions, CircleCI, Datadog, Slack, and more.</li><li>Creating snapshots for each named volume in your application setup.</li><li>Monitoring your deployment while tracking build details & application history.</li></ul><p>LocalStack has been in active partnership with Shipyard and both companies are on a mission to streamline the Software Development Life Cycle (SDLC) and provide frictionless developer experience. This partnership is in line with our shared vision of bolstering the DevOps methodologies while providing an improved testing process, quicker release cycles, and optimized cost utilization ‚Äî all while adhering to security best practices.</p><blockquote class=twitter-tweet><p lang=en dir=ltr>We've just passed 150,000,000+ pulls for the official LocalStack Docker image üìàüí™<br><br>Glad to see the community grow & propel our dream of a fully local cloud dev & test, powered by LocalStack! ü•≥<br><br>Here's to the next milestone! ü•Ç<a href="https://twitter.com/hashtag/LocalStack?src=hash&ref_src=twsrc%5Etfw">#LocalStack</a> <a href="https://twitter.com/hashtag/Docker?src=hash&ref_src=twsrc%5Etfw">#Docker</a> <a href="https://twitter.com/hashtag/AWS?src=hash&ref_src=twsrc%5Etfw">#AWS</a> <a href="https://twitter.com/hashtag/CloudDevelopment?src=hash&ref_src=twsrc%5Etfw">#CloudDevelopment</a> <a href=https://t.co/ZCJre3mJOC>pic.twitter.com/ZCJre3mJOC</a></p>&mdash; LocalStack (@localstack) <a href="https://twitter.com/localstack/status/1670776943359447040?ref_src=twsrc%5Etfw">June 19, 2023</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><p>LocalStack‚Äôs cloud emulation capabilities allow you to create resources such as S3 buckets, DynamoDB tables, OpenSearch clusters, and more to replicate cloud environments. With significant recent enhancements to these services, you can now preview features in your cloud applications, and use additional features such as Cloud Pods to pre-seed your infrastructure state automatically. Upon creating a pull request, Shipyard automatically creates an ephemeral environment that allows you to test your application in a state that is infrastructure-identical to production, making it easy to collaborate asynchronously within and across your team!</p><h2 id=how-to-use-shipyard-with-localstack>How to use Shipyard with LocalStack?</h2><p>In this section, we‚Äôll run a basic item tracker application on Shipyard using DynamoDB & Simple Email Service (SES) provisioned by LocalStack. The item tracker application allows users to submit data to a DynamoDB table using a ReactJS client and a Flask backend, using the <a href=https://aws.amazon.com/sdk-for-python/>AWS SDK for Python (<code>boto3</code>)</a> using a basic CRUD interface. It then uses SES to mock the process of sending email reports of work items.</p><p>For this walkthrough, you‚Äôll need to have the following prerequisites installed on your local machine:</p><ul><li><a href=https://docs.docker.com/engine/install/>Docker</a> & <a href=https://docs.docker.com/compose/install/>Docker Compose</a></li><li>AWS CLI & <a href=https://docs.localstack.cloud/user-guide/integrations/aws-cli/#localstack-aws-cli-awslocal><code>awslocal</code> wrapper script</a></li><li><a href=https://shipyard.build/signup>Shipyard account</a> with an active subscription (sign up for a free trial)</li><li><a href=https://app.localstack.cloud/sign-up>LocalStack Web Application account</a></li><li><a href=https://docs.localstack.cloud/getting-started/installation/#localstack-cli><code>localstack</code> CLI</a> with <a href=https://docs.localstack.cloud/getting-started/auth-token/><code>LOCALSTACK_AUTH_TOKEN</code></a></li></ul><h3 id=set-up-the-application-on-your-local-machine>Set up the application on your local machine</h3><p>The code for the solution in this post is in <a href=https://github.com/localstack-samples/sample-item-tracker-shipyard-application>this repository on GitHub</a>. To get started, fork the repository on GitHub. You can now use <code>git clone</code> to clone the repository onto your local developer machine:</p><pre><code class=language-bash>git clone https://github.com/localstack-samples/sample-item-tracker-shipyard-application
cd sample-item-tracker-shipyard-application
</code></pre><p>Replace the GitHub repository URL with the URL of the forked repository. Open the code in your favourite code editor/IDE. You‚Äôll be able to check out the Docker Compose configuration that sets up the application on your local machine. Here is what it looks like:</p><pre><code class=language-yaml>version: '3'

services:

  localstack:
    container_name: &quot;${LOCALSTACK_DOCKER_NAME-localstack_main}&quot;
    image: localstack/localstack-pro:latest
    ports:
      - &quot;127.0.0.1:4566:4566&quot;            # LocalStack Gateway
      - &quot;127.0.0.1:4510-4559:4510-4559&quot;  # external services port range
      - &quot;127.0.0.1:443:443&quot;
    environment:
      - LOCALSTACK_AUTH_TOKEN=${LOCALSTACK_AUTH_TOKEN:?}
      - DEBUG=1
      - DOCKER_HOST=unix:///var/run/docker.sock
      - EXTRA_CORS_ALLOWED_ORIGINS='*'
    volumes:
      - &quot;./init-aws.sh:/etc/localstack/init/ready.d/init-aws.sh&quot;
      - &quot;localstack:/var/lib/localstack&quot;
      - &quot;/var/run/docker.sock:/var/run/docker.sock&quot;
    networks:
      ls:
        ipv4_address: 10.0.2.20

  frontend:
    container_name: react
    labels:
      shipyard.route: '/'
      shipyard.primary-route: 'true'
    build: 'frontend'
    volumes:
      - './frontend/src:/app/src'
      - './frontend/public:/app/public'
    ports:
      - '3000:3000'

  backend:
    container_name: flask
    labels:
      shipyard.route: '/api'
    build: 'backend'
    environment:
      SHIPYARD_DOMAIN_FRONTEND: ${SHIPYARD_DOMAIN_FRONTEND-}
      SHIPYARD_DOMAIN: ${SHIPYARD_DOMAIN}
    ports:
      - '8080:8080'
    dns:
      - 10.0.2.20
    networks:
      - ls

networks:
  ls:
    ipam:
      config:
        - subnet: 10.0.2.0/24
volumes:
  localstack:
</code></pre><p>In the above Docker Compose configuration, we have created:</p><ul><li>A <code>localstack</code> service which pulls the <code>localstack/localstack-pro</code> Docker image and sets up an initialization hook that creates the AWS resources on the host machine.</li><li>A <code>frontend</code> service that installs the dependencies & builds the ReactJS application served on port 3000 using the <code>Dockerfile</code> in the <code>frontend</code> directory.</li><li>A <code>backend</code> service that installs the dependencies and starts a development Flask server on port 8080 using the <code>Dockerfile</code> in the <code>backend</code> directory.</li><li>An <code>ls</code> Docker network that allows the <code>backend</code> service to use LocalStack as its DNS server and ensure that it can access the LocalStack container.</li></ul><p>Additionally, you will notice that we have configured the Shipyard-specific service labels to specify the frontend domain, primary route, and main domain. This is useful in the context of a multi-domain environment like ours. You can check more about them on <a href=https://docs.shipyard.build/docs/docker-compose/#routing>Shipyard‚Äôs documentation</a>.</p><h3 id=start-the-application-on-your-local-machine>Start the application on your local machine</h3><p>You can now start the application locally, by specifying the following command:</p><pre><code class=language-bash>export LOCALSTACK_AUTH_TOKEN=&lt;your-auth-token&gt;
docker-compose up
</code></pre><p>This will start the <code>localstack</code>, <code>backend</code>, and <code>frontend</code> services, exposing the user client to <code>localhost:3000</code>. You can navigate to the local user client to start interacting with the application by adding items which are fully persisted using the emulated DynamoDB table.</p><img class="img-simple img-fluid lazyload blur-up" src=/2024-04-22-ephemeral-environments-with-localstack-shipyard/item-tracker-application_hu15db7aa9a0fee604128ef20810756a1f_2063333_20x0_resize_box_2.png data-src=/2024-04-22-ephemeral-environments-with-localstack-shipyard/item-tracker-application.png width=3680 height=2228 alt="Picture showing the item tracker application working"><p>You can also use the REST API client to add items to the application by performing a <code>POST</code> request. Here is an example:</p><pre><code class=language-bash>curl -X POST http://localhost:8080/api/items \
    -H &quot;Content-Type: application/json&quot; \
    -d '{&quot;name&quot;:&quot;Me&quot;,&quot;guide&quot;:&quot;python&quot;,&quot;description&quot;:&quot;Show how to add an item&quot;,&quot;status&quot;:&quot;In progress&quot;,&quot;archived&quot;:false}'
</code></pre><p>You can also use the REST API to get any existing active items using the following command:</p><pre><code class=language-bash>curl -X GET http://localhost:8080/api/items?archived=false
</code></pre><p>You can fetch an email report by adding <a href=mailto:hello@example.com><code>hello@example.com</code></a> in the <strong>Email Report</strong> tab and clicking <strong>Send report</strong>. Navigate to the LocalStack Web Application, and you‚Äôll be able to find the sent emails on the <a href=https://app.localstack.cloud/inst/default/resources/ses/identities>SES Resource Browser</a>.</p><img class="img-simple img-fluid lazyload blur-up" src=/2024-04-22-ephemeral-environments-with-localstack-shipyard/ses-resource-browser_hu15db7aa9a0fee604128ef20810756a1f_2462571_20x0_resize_box_2.png data-src=/2024-04-22-ephemeral-environments-with-localstack-shipyard/ses-resource-browser.png width=3680 height=2228 alt="LocalStack SES Resource Browser"><p>You can also scan the DynamoDB table you have deployed using the following command:</p><pre><code class=language-bash>awslocal dynamodb scan --table-name doc-example-work-item-tracker
</code></pre><p>In the output, you will find the persisted data available.</p><h3 id=configure-your-application-on-shipyard>Configure your application on Shipyard</h3><p>You can now create an ephemeral environment for your cloud application on Shipyard. Navigate to your Shipyard dashboard and click on <strong>+ Application</strong>. Choose the GitHub repository you have forked and the <code>main</code> branch to start.</p><img class="img-simple img-fluid lazyload blur-up" src=/2024-04-22-ephemeral-environments-with-localstack-shipyard/create-application-shipyard_hu3111237ca1621ec276ef98323d77a601_239114_20x0_resize_box_2.png data-src=/2024-04-22-ephemeral-environments-with-localstack-shipyard/create-application-shipyard.png width=3420 height=1829 alt="Create an application on Shipyard"><p>Click on the <strong>Select services</strong> to add services that you would like to deploy. These services are automatically selected from the Docker Compose configuration.</p><img class="img-simple img-fluid lazyload blur-up" src=/2024-04-22-ephemeral-environments-with-localstack-shipyard/shipyard-select-services_hu0b3f0395a2044826725f638fe7693875_355612_20x0_resize_box_2.png data-src=/2024-04-22-ephemeral-environments-with-localstack-shipyard/shipyard-select-services.png width=3456 height=1830 alt="Selecting Docker Compose services on Shipyard"><p>Click on the <strong>Add environment variables</strong> to go to the next step, and add the <code>LOCALSTACK_AUTH_TOKEN</code> as an environment variable to authenticate with LocalStack. Finally, click on <strong>Create application</strong> to get started with the first build of your application! After a successful build, you can now click on the <strong>Visit</strong> button on your application dashboard to navigate to the deployed application.</p><p>You can start interacting with the application, and review the run logs for your application&rsquo;s services.</p><img class="img-simple img-fluid lazyload blur-up" src=/2024-04-22-ephemeral-environments-with-localstack-shipyard/localstack-container-logs_hu774a2e1fba2f9b954b867330745e21f5_439259_20x0_resize_box_2.png data-src=/2024-04-22-ephemeral-environments-with-localstack-shipyard/localstack-container-logs.png width=3410 height=1468 alt="LocalStack Container logs on Shipyard"><h3 id=enable-previews-for-your-ephemeral-environments>Enable previews for your ephemeral environments</h3><p>You can now create previews for your ephemeral application deployed on Shipyard. The preview follows the lifecycle of a pull request (PR), and makes sure that:</p><ul><li>A new ephemeral environment is deployed in Shipyard with the new commits in the PR.</li><li>The PR is updated with the deployed application URL and the build details for quick debugging.</li></ul><p>The sample repository above has already been configured with a sample GitHub Action workflow. The workflow looks like this:</p><pre><code class=language-yaml>name: Deploy on Shipyard

on: [pull_request]

jobs:
  deploy:
    runs-on: ubuntu-latest
    name: Deploy
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Integrate Shipyard
        uses: shipyard/shipyard-action@1.0.0
        env:
          SHIPYARD_API_TOKEN: ${{ secrets.SHIPYARD_API_TOKEN }}
          SHIPYARD_APP_NAME: &quot;localstack-shipyard-item-tracker&quot;
</code></pre><p>The workflow uses the <code>SHIPYARD_API_TOKEN</code>. Add it to your forked GitHub repository using secrets in GitHub Actions.</p><p>Now create a new branch in your local repository, and make a small change. After making the changes, stage it, push the commits into the branch and create a new pull request. Shipyard will automatically start a new ephemeral deployment. You can see the workflow&rsquo;s status and logs in the <code>checks</code> section of the pull request. After a few seconds, the workflow will add the preview URL. Click on it to see your changes in real time.</p><img class="img-simple img-fluid lazyload blur-up" src=/2024-04-22-ephemeral-environments-with-localstack-shipyard/shipyard-pr-previews_huda63a9a158546df9f5f440de1275499f_199235_20x0_resize_box_2.png data-src=/2024-04-22-ephemeral-environments-with-localstack-shipyard/shipyard-pr-previews.png width=2790 height=810 alt="Shipyard spinning up another environment for the new Pull request"><h3 id=use-cloud-pods-to-pre-seed-infrastructure-state>Use Cloud Pods to pre-seed infrastructure state</h3><p>In various testing scenarios, you might often feel the need to create test fixtures or additional resources to bootstrap your testing environment and test your application. <a href=https://docs.localstack.cloud/user-guide/state-management/cloud-pods/>LocalStack‚Äôs Cloud Pods</a> can facilitate and dramatically simplify this task. Cloud Pods allow you to take a snapshot of the state at any point in time, and then selectively restore, merge, and inject it into your LocalStack container.</p><p>In this scenario, you can pre-seed your previews with the DynamoDB state using a Cloud Pod that contains the state and configuration of the DynamoDB table. This Cloud Pod would be available in the Cloud Pod storage space on the LocalStack Web Application and can be used in CI to bootstrap the testing environment where the application is then deployed and tested. Moreover, each developer can pull the same Cloud Pod and run some local tests.</p><p>To create a Cloud Pod, navigate to the local application and run the following script that inserts some sample data into your DynamoDB table:</p><pre><code class=language-bash>./scripts/seed.sh
</code></pre><p>You can now take an infrastructure snapshot with the Cloud Pods using the following command:</p><pre><code class=language-bash>localstack pod save item-tracker-application
</code></pre><p>You will see the following output in your terminal:</p><pre><code class=language-bash>Cloud Pod `item-tracker-application` successfully created ‚úÖ
Version: 1
Remote: platform
Services: dynamodb,ses
</code></pre><p>You can also navigate to the <a href=https://app.localstack.cloud/pods>Cloud Pods browser</a>, where you can find the newly created Cloud Pod stored on the LocalStack Web Application. Navigate to the local application setup, and add the following to your Docker Compose configuration file to auto-load the Cloud Pod, using the <a href=https://docs.localstack.cloud/user-guide/state-management/cloud-pods/#environmental-variables><code>AUTO_LOAD_POD</code> configuration</a>, and remove the initialization hook.</p><pre><code class=language-yaml>AUTO_LOAD_POD=item-tracker-application
</code></pre><p>This will ensure that on the LocalStack container startup, the Cloud Pod will be loaded automatically thus pre-seeding your infrastructure state. The Docker Compose configuration will look like this:</p><pre><code class=language-yaml>environment:
  - LOCALSTACK_AUTH_TOKEN=${LOCALSTACK_AUTH_TOKEN:?}
  - DEBUG=1
  - DOCKER_HOST=unix:///var/run/docker.sock
  - EXTRA_CORS_ALLOWED_ORIGINS='*'
  - AUTO_LOAD_POD=item-tracker-application
volumes:
  - &quot;localstack:/var/lib/localstack&quot;
  - &quot;/var/run/docker.sock:/var/run/docker.sock&quot;
</code></pre><p>Commit and push this on the <code>main</code> branch of the repository. After a successful build & deployment, you can now visit the newly deployed application, to find the DynamoDB table successfully seeded in the application setup, which is further reflected in the web client.</p><img class="img-simple img-fluid lazyload blur-up" src=/2024-04-22-ephemeral-environments-with-localstack-shipyard/application-cloud-pods_hu15db7aa9a0fee604128ef20810756a1f_2560219_20x0_resize_box_2.png data-src=/2024-04-22-ephemeral-environments-with-localstack-shipyard/application-cloud-pods.png width=3680 height=2228 alt="Application pre-seeded with the Cloud Pods"><p>In addition to preseeding your Shipyard environment, Cloud Pods can also be used at the ‚Äúother end‚Äù of a pipeline, namely to store and push the state of the LocalStack instance after an ephemeral run has been completed. This allows you to replicate the same state onto the local machine, in case your integration test suite fails on the ephemeral environment.</p><h2 id=key-benefits>Key Benefits</h2><p>There are several key benefits of using Shipyard and LocalStack to develop & test cloud applications:</p><ul><li>Improve the development process for cloud infrastructure by allowing developers to test code changes in isolation and iterate quickly.</li><li>Save time and money by eliminating the need to wait for staging to be configured and blocking other team members during the process.</li><li>Facilitate collaboration across different teams by providing a freshly-configured pre-production environment for everyone to work in.</li><li>Run your automated end-to-end (E2E) test suite and pre-seed your infrastructure & application state to allow more thorough testing.</li><li>Streamline the login process (SSO) for your team to prevent anyone outside your organization from accessing your environments.</li></ul><h2 id=conclusion>Conclusion</h2><p>Congratulations! You‚Äôve successfully deployed an AWS-powered cloud application on an ephemeral environment using LocalStack & Shipyard. With LocalStack, you don&rsquo;t have to worry about losing your infrastructure state after tearing down your ephemeral environments after a quick round of testing. LocalStack allows you to persist the resources created on the host machine for extensive testing and further use Cloud Pods to pre-seed the infrastructure state as and when required!</p><p>You can further explore Shipyard and their offering for various use cases such as:</p><ul><li>Adding <a href=https://docs.shipyard.build/docs/datadog>Datadog logging</a> and integrating with LocalStack‚Äôs serverless resources, such as <a href=https://docs.localstack.cloud/user-guide/aws/lambda/>Lambda</a>, <a href=https://docs.localstack.cloud/user-guide/aws/eventbridge/>EventBridge</a>, <a href=https://docs.localstack.cloud/user-guide/aws/sqs/>SQS</a>, and more.</li><li>Using <a href=https://docs.shipyard.build/docs/volume-management>Shipyard‚Äôs volume management</a> to revert the data in case of regression and load them across sibling environments.</li><li>Monitoring key infrastructure metrics such as an overview of <a href=https://docs.shipyard.build/docs/build-details>build and deploy times, CPU/Memory usage, and deployment timeline</a>.</li></ul><p>If you have any questions about configuring and running your project, drop by <a href=https://shipyardcommunity.slack.com/join/shared_invite/zt-1y44cpq6u-rJT~kg9wArqxP~N1F3K_pA#/shared-invite/email>Shipyard</a> or <a href=https://localstack.cloud/slack>LocalStack</a> community. We would love to hear your feedback about this integration. Happy cloud testing!</p></article></div></div></div></section><section class="section bg-gradient-light"><div class=container><div class="row justify-content-center"><div class="d-flex flex-column gap-4 col-lg-12 text-white"><h2 class="h2 text-center">Stay in the loop</h2><p>We'd love to get in touch with you.
Please subscribe with your email to stay tuned for release notes and product updates.
We promise never to send an excessive amount of emails (we hate spam, too).</p><script>hbspt.forms.create({region:"eu1",portalId:"26596507",formId:"1cc99237-4ce0-4d65-abdf-f87ac2724717"})</script></div></div></div></section><footer class="footer pt-6 bg-gradient-dark"><div class="footer-main pb-5"><div class=container><div class="row justify-content-between"><div class="col-12 col-lg-4"><img style=width:243px src=/images/header-logo-new.svg alt="LocalStack Logo"></div><div class="col-12 col-lg-8 mt-4 mt-lg-0"><div class="row gap-4"><div class=col><ul class="list-unstyled gap-4 d-flex flex-column"><li><a class=footer-text href=https://localstack.cloud/contact>Contact</a></li><li><a class=footer-text href=https://localstack.cloud/careers>Careers</a></li><li><a class=footer-text href=https://blog.localstack.cloud>Blog</a></li><li><a class=footer-text href=https://docs.localstack.cloud>Docs</a></li></ul></div><div class=col><ul class="list-unstyled gap-4 d-flex flex-column"><li><a class=footer-text href=https://docs.localstack.cloud/tutorials/>Tutorials</a></li><li><a class=footer-text href=https://docs.localstack.cloud/applications/>Applications</a></li><li><a class=footer-text href=https://docs.localstack.cloud/academy/>LocalStack Academy</a></li></ul></div><div class=col><ul class="list-unstyled gap-4 d-flex flex-column"><li><a class=footer-text href=https://www.localstack.cloud/legal/tos>Terms and Conditions</a></li><li><a class=footer-text href=https://www.localstack.cloud/legal/privacy-policy>Privacy Policy</a></li><li><a class=footer-text href=https://assets-global.website-files.com/6539036f80ddc9e9a467134e/657b15a7f5ba23e41984d5dd_LocalStack%20DPA.pdf>Data Processing Addendum</a></li></ul></div><div class=col><ul class="list-unstyled gap-4 d-flex flex-column"><li class=footer-text>Follow us</li><li class="d-flex gap-3"><a class=footer-text href=https://twitter.com/localstack><span><svg width="26" height="26" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M25 13.25c0 6.9036-5.5964 12.5-12.5 12.5C5.59644 25.75.0 20.1536.0 13.25.0 6.34644 5.59644.75 12.5.75 19.4036.75 25 6.34644 25 13.25zm-6.56-3.0468C19.0443 10.1315 19.6205 9.97084 20.1562 9.73331 19.7558 10.3325 19.2493 10.8586 18.6651 11.2797 18.6709 11.4076 18.6738 11.5366 18.6738 11.6661c0 3.9487-3.0055 8.5014-8.5012 8.5014C8.48534 20.1675 6.91443 19.6731 5.59285 18.825 5.82615 18.8528 6.06457 18.8669 6.30522 18.8669 7.70545 18.8669 8.9936 18.3894 10.0164 17.5879 8.70861 17.5636 7.6054 16.6997 7.22527 15.5129 7.40754 15.5477 7.59449 15.5662 7.78745 15.5662 8.05952 15.5662 8.32401 15.5299 8.57447 15.4612c-1.36658-.2743-2.39692-1.4817-2.39692-2.9294C6.17755 12.5193 6.17755 12.5066 6.17777 12.4939 6.58041 12.7183 7.04144 12.8526 7.53098 12.868 6.7297 12.3323 6.20183 11.4174 6.20183 10.3811c0-.547520000000001.14751-1.06113.40465-1.50232C8.08024 10.687 10.282 11.8764 12.7651 12.001 12.7139 11.7822 12.6874 11.5542 12.6874 11.32c0-1.64975 1.338-2.98781 2.9878-2.98781.8599.0 1.6364.36276 2.1815.94322C18.5369 9.14149 19.1767 8.89304 19.754 8.55056 19.5305 9.24867 19.057 9.83358 18.44 10.2032z" fill="#fff"/></svg></span></a><a class=footer-text href=https://www.linkedin.com/company/localstack-cloud><span><svg width="26" height="26" viewBox="0 0 26 26" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M13 26c7.1797.0 13-5.8203 13-13S20.1797.0 13 0 0 5.8203.0 13 5.8203 26 13 26zM9.35126 10.5024C9.97963 10.5024 10.489 9.993 10.489 9.36463S9.97963 8.22687 9.35126 8.22687 8.2135 8.73626 8.2135 9.36463s.50939 1.13777 1.13776 1.13777zm2.21194.8622v6.3122h1.9599V14.5553C13.5231 13.7316 13.6781 12.9339 14.6993 12.9339c1.0073.0 1.0198.941700000000001 1.0198 1.6734v3.0701H17.68V14.2157C17.68 12.5153 17.3139 11.2086 15.3265 11.2086c-.9542.0-1.5938.5236-1.8554 1.0192H13.4446V11.3646H11.5632zm-3.19382.0H10.3324v6.3122H8.36938V11.3646z" fill="#fff"/></svg></span></a></li></ul></div></div></div></div></div></div><div class=footer-bottom><div class="container mb-2"><hr><div class="row pt-4"><div class=col style=color:#fff;opacity:.5>Copyright &copy; LocalStack</div><div class="col text-end"><ul class=list-inline></ul></div></div></div></div></footer><script src=/js/bootstrap.min.51b4083a09e54138d5bbe9c42a5f5f71af6e60a417f276d5620cbde3b15eb1a07c9ea17a889bc58074adf9b19641039a77521d3131f039300d2fe29ffa532aa8.js integrity="sha512-UbQIOgnlQTjVu+nEKl9fca9uYKQX8nbVYgy947FesaB8nqF6iJvFgHSt+bGWQQOad1IdMTHwOTANL+Kf+lMqqA==" crossorigin=anonymous defer></script><script src=/js/highlight.min.8cdbefd08ec63ef25f4b2510ae50c13b3d9ed43e25a15ddb55f14c33130e68cf8be3131ccf2d087c49f5f21fe88c2f0e2715a21f936047d0d0b85dc48cb864b9.js integrity="sha512-jNvv0I7GPvJfSyUQrlDBOz2e1D4loV3bVfFMMxMOaM+L4xMczy0IfEn18h/ojC8OJxWiH5NgR9DQuF3EjLhkuQ==" crossorigin=anonymous defer></script><script src=/main.min.8933efb6bcdc37606a11f732d52c6f65d7fc1d082b89d56516f6a1bfb528ee7c40c3430bb80214cdd129ec7d69d4cadd74e693da54a9ba6f08c44771204d4468.js integrity="sha512-iTPvtrzcN2BqEfcy1SxvZdf8HQgridVlFvahv7Uo7nxAw0MLuAIUzdEp7H1p1MrddOaT2lSpum8IxEdxIE1EaA==" crossorigin=anonymous defer></script><script src=/index.min.28297aad85d5f5902201eb4ef84e7012a37d4a34824e2256df80cd91e547bf155df22029e5596951d6f2692dd1fee54c76721b407e5ac526bd33bedc636a87e5.js integrity="sha512-KCl6rYXV9ZAiAetO+E5wEqN9SjSCTiJW34DNkeVHvxVd8iAp5VlpUdbyaS3R/uVMdnIbQH5axSa9M77cY2qH5Q==" crossorigin=anonymous defer></script></body></html>